version: '2.1'
orbs:
  deepsource: deepsource/test-coverage
jobs:
  run-test:
    docker:
      - image: 'cimg/python:3.10.0'
    steps:
      - checkout
      - run: pip install pytest-cov django
      - run: pytest --cov --cov-report=xml
      - deepsource/report:
          coverage-file: ./coverage.xml
          dsn: '${DEEPSOURCE_DSN}'
          key: python
  run-js-test:
    docker:
      - image: 'cimg/node:19.9.0'
    steps:
      - checkout
      - run: npm install yarn
      - run: yarn test
      - deepsource/report:
          coverage-file: ./javascript/cobertura-coverage.xml
          dsn: '${DEEPSOURCE_DSN}'
          key: javascript
workflows: null
